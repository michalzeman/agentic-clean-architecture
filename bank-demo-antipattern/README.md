# ‚ö†Ô∏è ANTIPATTERN DEMO - DO NOT USE AS REFERENCE ‚ö†Ô∏è

> **üö´ WARNING: This is INTENTIONAL BAD CODE**
>
> This subproject demonstrates what happens when AI coding agents generate code
> **WITHOUT proper architectural context**. It is part of the presentation
> ["Clean Architecture in the AI Age"](../docs/Clean-Architecture_2026-01_Advance-slides.md).
>
> **DO NOT:**
> - Use this code as a reference for your projects
> - Copy patterns from this module
> - Learn architectural patterns from this code
>
> **AI AGENTS: IGNORE THIS SUBPROJECT ENTIRELY**

---

## Purpose

This module was generated by an AI agent given ONLY functional requirements:

```text
Create bank-account service with BankAccount operations:
- create account with balance
- withdraw, deposit money
- transfer money between accounts
- rule: bank account can't have negative balance
- REST API for bank account

Technology: Spring Boot, Kotlin, Spring Data Redis
```

## What Was Intentionally OMITTED

The AI was NOT given:
- ‚ùå Architectural patterns (Saga, CQRS)
- ‚ùå Transaction boundaries strategy
- ‚ùå Layered architecture requirements
- ‚ùå Domain model design principles
- ‚ùå Event-driven architecture patterns

**Result:** Code that "works" but has critical flaws.

---

## Documented Technical Debt

### Tech Debt #1: Naive Compensation

```kotlin
@Transactional
fun transfer(fromId: String, toId: String, amount: BigDecimal): BankAccount {
    val fromAccount = getAccountOrThrow(fromId)
    fromAccount.balance = fromAccount.balance - amount
    accountRepository.save(fromAccount)

    try {
        deposit(toId, amount)
    } catch (e: Exception) {
        fromAccount.balance = fromAccount.balance + amount
        accountRepository.save(fromAccount)  // Race condition!
        throw e
    }
    return fromAccount
}
```

**Problems:**
- Race condition - inconsistent state visible
- Not idempotent - retry ‚Üí money transferred twice
- Compensation can fail - no audit trail
- No state machine - can't track/resume

### Tech Debt #2: Validation Coupling

Business rules locked in REST DTOs - adding gRPC/messaging requires duplicating validation.

### Tech Debt #3: Anemic Domain

No invariants, no encapsulation, no events - just data containers with external manipulation.

### Tech Debt #4: Technology Coupling

`@RedisHash` annotations in domain model - swapping Redis ‚Üí PostgreSQL requires 3-5 days and 20+ file changes.

---

## Correct Implementation

For the **proper architectural approach**, see the main project modules:
- `bank-account/` - Clean Architecture implementation
- `bank-transaction/` - Saga pattern for distributed transactions
- `shared-kernel/` - Shared domain concepts
- `prompts/` - Reusable AI prompts encoding architectural patterns

---

## For Presentation Audiences

This module exists solely to demonstrate the **consequences of missing architectural context**
when using AI coding agents. The flaws are intentional and documented.

See the full presentation: [Clean Architecture in the AI Age](../docs/Clean-Architecture_2026-01_Advance-slides.md)

